<p>Like I mentioned in one of my previous posts, I was thinking on how to develop a report development suite using Silverlight and WCF as the backbone. In that process I had several questions for which I had been digging around the internet to see if I could get some answers. The intention of this post is to log my findings. Please note that I do not own the content posted here and I appreciate all the effort that the authors have put into writing these articles.</p>  <p><strong>1. How would I bind unknown objects to the Silverlight Datagrid (or any grid for that matter)?</strong></p>  <p>Problem: My plan is to take in queries that generates reports and run them against a database (SQL or Oracle). The returned results should bind to the datagrid. So I am not sure on what columns would be returned from the result set and more over I do not know what type of class should I be creating in advance so as to support all the possible results returned. Some times it might just return EmployeeName, EmployeeId while some other time it might just return EmployeeName, EmployeeSalary, EmployeeHikePercent. So the question is on how to generate dynamic typed objects in C#. </p>  <p>Solution: One idea is to generate IEnumerable&lt;IDictionary&gt; as described in Vladimir&#8217;s blog. </p>  <p><a title="How-to-bind-Silverlight-DataGrid-from-IEnumerable-of-IDictionary" href="http://blog.bodurov.com/How-to-bind-Silverlight-DataGrid-from-IEnumerable-of-IDictionary">How-to-bind-Silverlight-DataGrid-from-IEnumerable-of-IDictionary</a></p>  <p><strong>2. I would like to get a general idea on how to go ahead developing business/enterprise class applications in Silverlight. Is there a reference implementation or a tutorial?</strong></p>  <p>Problem: Doing simple stuff in Silverlight is fairly easy but developing enterprise line-of-business applications using Silverlight would require decent experience with the new programming model that silverlight brings in. So learning from other&#8217;s experience would be great.</p>  <p>Solution: Look at Chris Andersons&#8217; wonderful series on developing LOB applications in Silverlight.</p>  <p><a title="Building-a-Framework-for-Silverlight-Line-Of-Business-Applications.aspx" href="http://www.silverlightshow.net/items/Building-a-Framework-for-Silverlight-Line-Of-Business-Applications.aspx">Building-a-Framework-for-Silverlight-Line-Of-Business-Applications.aspx</a></p>  <p><strong>3. Now let us think deep. Let us assume that somehow I am able to send my data using WCF service. The problem would be &#8211; what the most performance efficient way to implement paging or infinite scrolling?</strong></p>  <p>Problem: you have the datasource and the most common requirement is to implement Paging functionality in the grid. So how would I go about doing this. Are there any clever methods?</p>  <p>Solution: Look at the following links. They are all very useful.</p>  <p><a title="scrolling-through-large-resultset-with-silverlight-2-beta1-and-linq-to-sql.aspx" href="http://blogs.msdn.com/swiss_dpe_team/archive/2008/05/09/scrolling-through-large-resultset-with-silverlight-2-beta1-and-linq-to-sql.aspx">scrolling-through-large-resultset-with-silverlight-2-beta1-and-linq-to-sql.aspx</a></p>  <p><a title="stealth-paging-datagrid.aspx" href="http://weblogs.asp.net/manishdalal/archive/2008/10/09/stealth-paging-datagrid.aspx">stealth-paging-datagrid.aspx</a></p>  <p><strong>4. How about support for large datasets returned from the service?</strong></p>  <p>I know with my 0.01 cent worth knowledge on WCF, it is too early for me to think on these lines but anyway the problem that I foresee is that if WCF service sends large dataset to the Silverlight client, the client application eventually runs out of memory. So how would I handle it. </p>  <p>So far, I just found this - <a title="http://weblogs.asp.net/cibrax/archive/2008/06/10/streaming-large-content-with-wcf-and-deferred-execution.aspx" href="http://weblogs.asp.net/cibrax/archive/2008/06/10/streaming-large-content-with-wcf-and-deferred-execution.aspx">http://weblogs.asp.net/cibrax/archive/2008/06/10/streaming-large-content-with-wcf-and-deferred-execution.aspx</a></p>  <p><strong>5. More on large datasets, sorting, grouping on paged datagrids.</strong></p>  <p>Problem: Let us assume that we have loaded only the first page of data in the datagrid and when we sort, the grid only sorts that particular page. But the client expects to see the whole data sorted and return only the first page. How would I achieve this with Silverlight datagrid and WCF as a data providing service?</p>  <p>Solution: On this one, I am yet to find proper solutions. May be I am not looking right.<strong> so if anyone reading this blog has prior idea on how to&#160; do this, I would be glad if you can share your experience or idea (need not share code as such, I am just looking for a proper pattern to do this).</strong> </p>  <p><strong>6. The users viewing the report might want to apply certain filters. How would I go ahead and provide such a functionality?</strong></p>  <p>Problem: Let us assume we displayed certain report. Now it would be nice if the user can view only those records which meets his criteria. So we provide the user with some filtering capabilities. The user would add a new filter expression which would be something like &#8220;ColumnX = 100&#8221;. So the filter should be evaluated and be applied on the dataset and display only those records which satisfy the filters specified.</p>  <p>Solution: One way is to use dynamic linq (<a title="http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx" href="http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx">http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx</a>) which allows string LINQ expressions. So the user would be writing LINQ expressions which would be evaluated runtime and the result would be returned.</p>  <p><strong>7. What if the user wishes to have more control, then he could write a filter in languages like IronRuby, IronPython and Managed JScript.</strong></p>  <p>Problem: Consider the same scenario as above but with a more complex scenario. The user wishes to execute some script on the result returned, save the script as a filter and apply it on the report as he wishes to. So how would we provide such a capability ?</p>  <p>Solution: The idea would be to use DLR platform which provides scripting ability using DLR languages like IronRuby, IronPython and Managed JScript. For a basic understanding on how to enable your applications to have scripting ability, you might want to look at the following articles which discuss the subject in more detail.</p>  <p><a title="http://blogs.microsoft.co.il/blogs/shayf/archive/2009/02/01/make-your-application-extendable-using-the-dlr.aspx" href="http://blogs.microsoft.co.il/blogs/shayf/archive/2009/02/01/make-your-application-extendable-using-the-dlr.aspx">http://blogs.microsoft.co.il/blogs/shayf/archive/2009/02/01/make-your-application-extendable-using-the-dlr.aspx</a></p>  <p><a title="http://ironruby.rubyforge.org/wiki/wiki.pl?ExecutingIronRubyFromCSharp" href="http://ironruby.rubyforge.org/wiki/wiki.pl?ExecutingIronRubyFromCSharp">http://ironruby.rubyforge.org/wiki/wiki.pl?ExecutingIronRubyFromCSharp</a></p>  <p><a title="http://www.ironruby.net/Documentation/CLR_Interop" href="http://www.ironruby.net/Documentation/CLR_Interop">http://www.ironruby.net/Documentation/CLR_Interop</a></p>  <p><a title="http://msdn.microsoft.com/en-us/magazine/cc163284.aspx" href="http://msdn.microsoft.com/en-us/magazine/cc163284.aspx">http://msdn.microsoft.com/en-us/magazine/cc163284.aspx</a></p>  <p>My next immediate task is to be able to come up with a detailed article on how to make a simple extendable grid using WPF datagrid and IronRuby as scripting platform. Hopefully I should be done with it today and get a more detailed understanding on how things work.</p>  <p><strong>8. Microsoft&#8217;s Silverlight Datagrid is very basic. Can I have a better grid that is free to use?</strong></p>  <p>Problem: Silverlight datagrid does not provide functionality like grouping data, display summary items straight out of the box and requires more work. </p>  <p>Solution: Use DevExpress AgDataGrid the free silverlight datagrid control which has nice features like summary rows, sorting, grouping and many others that the Silverlight datagrid lacks.</p>  <p><strong>9. So where else can you think of using scripting functionality on the reporting suite.</strong></p>  <p>One idea is to auto-generate Ruby classes for a query based on the result returned, load them using DLR and generate data source out of it. But it might not actually be a great idea since I have no clue on how well it performs or how well it would act as a Data Transfer Object.</p>  <p>Custom Summary Rows : AgDatagrid allows us to display custom summary items which is very flexible. So we can extend the same flexibility to the report developer. He would write a script using one of the DLR languages which would be executed to get the custom summary value. This would make the application more flexible and depending on how well the developers are with scripting the possibilities are endless. Combined with filters functionality, this would turn out to be a great application to use &#8211; powerful and yet simple for basic reports.</p>  <p>Custom Event Handlers: Let us say the report has an event ReportDataFetched. Reports developer can specify a custom script which handles how the data would be filtered before actually rendering the data. He might want to filter out some data without even showing the user. Similarly such other events could be applied using scripting. For example, when we provide scheduling functionality we might have an event that says &#8220;ExecutionCompleteDataReady&#8221; which can execute a SendEmail script that the user would provide us.</p>  <p>With proper optimization of the script such that the end user does not feel bugged, DLR would be a great platform to make your applications extensible. You just need to figure out ways to work with it.</p>  <p><strong>10. Let us say everything is going well with the reporting suite and finally I would like to implement the following &#8211; Charts, Dynamic Charts, Exporting data to Excel-PDF-CSV, Exporting charts as images. How would I be doing all this?</strong></p>  <p>Silverlight, at this moment, does not allow data to be printed at the client. So the conversion should be done on the service. For this, I found a codeplex project called Exporter (<a title="Exporter" href="http://www.codeplex.com/Exporter">Exporter</a>). In order to generate charts in Excel documents, one could use the help of this <a title="bb407650.aspx" href="http://msdn.microsoft.com/en-us/library/bb407650.aspx">MSDN article</a>. Some discussion on this subject is <a href="http://stackoverflow.com/questions/373925/c-winforms-app-export-dataset-to-excel">available here.</a></p>  <p>As of the charts, <a href="http://www.codeplex.com/Silverlight/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%202&amp;referringTitle=Home">Silverlight charts</a> looks like a great suite that could be used. Another option is to use <a href="http://visifire.com/visifire_features.php">Visifire controls</a> <strike>but they are not free for commercial use</strike>.I received a comment from Chirag, Product Manager at Visifire stating that Visifire is indeed free for commercial applications <strong>if it conforms to the GPL.</strong>&#160;<strong><a href="http://www.codeplex.com/Silverlight">As a more important note, Silverlight Toolkit is a very good suite that one could use in many ways.</a></strong></p>  <p>If we move ahead on how to export Silverlight control rendered as an image, as a starting place, I would look at <a href="http://www.codeplex.com/silverlightcontrib">Silverlight Contrib project.</a> This project provides a Silverlight implementation of XamlWriter which can be used to get the XAML for the current silverlight element and then render it to a PNG<a href="http://blog.galasoft.ch/archive/2008/10/10/converting-and-customizing-xaml-to-png-with-server-side-wpf.aspx">. (Use this article)</a></p>  <p>I am glad on how this blog has turned out to be. It really helped me to think in the proper direction. Now in the next article I would focus on making extendible grid and demo the filter functionality with the help of DLR, I guess I would pick Ruby (I need to learn on how to use it, though).</p>  