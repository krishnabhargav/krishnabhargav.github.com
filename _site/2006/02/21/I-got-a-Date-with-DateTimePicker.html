<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Vedhava Sodhi - Musings of a Software Engineer v2.0</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    
    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="/">
                
                    <span class="blog-title">Vedhava Sodhi</span>
                 
            </a>
        </header>
        
        <span class="post-meta">
        	<time datetime="2006-02-21">21 Feb 2006</time>
        	
        		on
	        	
	        
       	</span>

        <h1 class="post-title">I got a Date with DateTimePicker</h1>

        <section class="post-content">
            <div style="text-align: justify;">Well, Recently i came across one cool problem. Yes! the problem is really cool and what makes me blog here is that there is no simple solution available online, for what i encountered.Thanks for Visual Studio.NET I could rectify the problem myself.<br /><br />DateTimePicker is a good control that solves most of our calender problems. It could be customized in different ways. Like we can customize the format in which the date appears. Also the look could be changed. Inorder to change the look from ComboBox style to updown-style just change the property "ShowUpDown" to true. It would give you two small updown arrows, that could be used to change the value.<br /><br />Each of us have our own taste for the way the date should appear, not only taste sometimes our requirements makes us change the display to something else. For example, at times we might need something like :<br />1/1/2005 10:05:00 AM<br />and sometimes just :<br />Jan 1 2005 10:05 AM<br />What i mean is that there are numerous ways in which DateTimePicker should display the value. So how do you tell the control what format it should display?<br />The answer is simple, you have the <span style="font-weight: bold;">Format</span> property on the DataTimePicker, which can take different values like Long,Short,Time and Custom(Clearly it is an enumeration).Programatically you can change the value as<br /><br />dtp1.Format=DateTimePickerFormat.Long or<br />dtp1.Format=DateTimePickerFormat.Short and so on.<br /><br />The most powerful of these Format values is Custom, which gives us fine grain control about the display. Working with Custom format is complex at first for those who havent worked with it till now. But it is simple then on. The steps are simple.<br />1. Set the Format property to "<span style="font-weight: bold;">Custom</span>"<br />2. You have another property "<span style="font-weight: bold;">CustomFormat</span>" on the DateTimePicker control which gets into action when Custom format is applied.<br />3. It is a string, so you can set a format as a string here. For example in order to display the date/time as February 21 10:00:00 PM, you can set the custom format as :<br /><br />dtp1.Format=DateTimePickerFormat.Custom<br />dtp1.CustomFormat="MMMM dd hh:mm:ss tt"<br /><br />4. Its over!!! Apply changes, check it out. You see exactly what i showed above.<br /><br />There are really numerous ways to customize like - you can also display the Day name like Friday, sat or Sun, more and more control is possible. You can even specify 24 hour format, i.e., if its 2 pm it could be shown as 14:00 . How do you do that?<br />See the following statement :<br />dtp1.CustomFormat="MMMM dd <span style="font-weight: bold;">HH</span>:mm:ss"<br />The display would be then February 21 14:00:00 ( its in 24 hour format now)<br /><br />Well i am done with my date, you need further details about the Customformat take a look at this link on MSDN<br />http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemwindowsformsdatetimepickerclasscustomformattopic.asp<br /><br />Now let me come to the cool problem i was talking about !!!<br /><span style="font-weight: bold;">Cool Problem - very hot!!</span><br />My requirement was that as soon as i load the form which has a DatetimePicker control, the control shoud display the current time ! Well it is rather simple, could be done in two ways.<br />1. dont set any default value during design time. OR<br />2. In the form load property, you can work this out as :<br /> a) first set the MaxDate property of dtp to DateTime.Max or anything else you wish. But not that if you set MaxDate as 2004 and you try to set the value greate than the MaxDate, say 2005, you ll encounter an exception. What i do usually is :<br /><br />dtp1.MaxDate=DateTime.MaxValue.AddDays(-2)<br /><br />I subtracted -2 because, the DateTimePicker cannot support anything that is after 12/31/9998 12:00:00 AM. if you say<br /><br />dtp1.MaxDate=DateTime.MaxValue<br /><br />You encounter this exception:<br />"DateTimePicker does not support dates after 12/31/9998 12:00:00 AM. Paramter name:value"<br /><br />And if you know, DateTime.MaxValue is "12/31/9999 11:59:59 PM. That is what DateTimePicker can support is exactly 1 year 1 sec less than the MaxValue. So you can Add -1 year and then add -1 second, but I wanted to be on safer side, so i directly add -2 years(means i remove 2 years from MaxValue which makes it 12/31/9997 11:59:59 PM, which is totally fine.<br />  b)  setting the MaxDate is really important because, if you dont do it and then say<br />            dtp1.Value=Date.Now<br /> you shall encounter this exception :<br /><span style="font-weight: bold;">'1/21/2006 1:06:00 PM' is not a valid value for 'Value'. 'Value' should be between MinDate and MaxDate.</span><br /> <br /> Now one can ask if i need to even set <span style="font-weight: bold;">MinDate,  </span>well it is not actually needed, but what you set at default value is applied as MinDate. So most of the times not needed, incase you set something other than Date.Now to the value of dtp and if you get an exception, you better set even the MinDate property to something else.<br /><br />All code at single place :<br />In Form load event<br /><br />dtp1.MaxDate=DateTime.Now.AddYears(-2)<br />dtp1.Value=DateTime.Now ' you can set the value.<br /><br />If you take the exception message 'Value' should be between...... and search in google - all you get is about DataBinding and databases. Well I havent worked on DataBinding much, so no idea about it. But there was no solution for this simple problem, atleast i did not find it.<br /><br />So I thought it would add my blog little value, if i present some article on how to work with DateTimePicker and a general problem when using it- along with my solution.<br /><br />Hope you .NET guys find it useful as much as i do. See you soon with another article.</div>
        </section>

        

        <footer class="post-footer">
        	<!-- If we want to display author's name and bio -->
            

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=I got a Date with DateTimePicker&amp;url=/2006/02/21/I-got-a-Date-with-DateTimePicker.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2006/02/21/I-got-a-Date-with-DateTimePicker.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2006/02/21/I-got-a-Date-with-DateTimePicker.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
            
            
        	
        </footer>

    </article>

</main>


    <footer class="site-footer">
        <a class="subscribe icon-feed" href="/rss.xml"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
             <section class="copyright">All content copyright <a href="/">Vedhava Sodhi</a> &copy;  &bull; All rights reserved.</section>
             <section class="poweredby">Made with Jekyll using <a href="http://github.com/rosario/kasper">Kasper theme</a></section>
        </div>
    </footer>

    
    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-XXXXXXXX-X']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>   
</body>
</html>
