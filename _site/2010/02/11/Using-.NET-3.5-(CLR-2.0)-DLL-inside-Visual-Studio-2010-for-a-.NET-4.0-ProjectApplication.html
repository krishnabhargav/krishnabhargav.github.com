<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Using .NET 3.5 (CLR 2.0) DLL inside Visual Studio 2010 for a .NET 4.0 Project/Application</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Using .NET 3.5 (CLR 2.0) DLL inside Visual Studio 2010 for a .NET 4.0 Project/Application</h2>
<p class="meta">11 Feb 2010</p>

<div class="post">
<p>When you first create a .NET 4.0 project inside VS 2010 and add reference to a .NET 3.5 DLL (say log4net or Rhino.Mocks), the project tends to not build. You can get errors as shown below.</p>  <p><a href="http://lh4.ggpht.com/_Oy9HuksgrdU/S3N4aGcY8iI/AAAAAAAABKo/13NGfYQ2S3c/s1600-h/image%5B3%5D.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_Oy9HuksgrdU/S3N4aRt67MI/AAAAAAAABKs/_y5ynd5233k/image_thumb%5B1%5D.png?imgmax=800" width="644" height="89" /></a> </p>  <p>It might appear to be a CLR version issue – unable to run 2.0 DLL inside a 4.0 App Domain. And i thought that is what it was until now. </p>  <p>You can get over this :) </p>  <p>By default, VS 2010 creates the projects with Target Framework on the properties set to “.NET Framework 4 Client Profile”. You would have to change that to “.NET Framework 4” by going to Project Properties –&gt; Application –&gt;&#160; Target Framework. And every thing begins to compile.</p>  <p>So I guess, one has to be aware of this when migrating old solutions from Visual Studio 2008 to Visual Studio 2010.</p>  <p>Proof that it works :) Notice the .NET Framework 4.0 features as well Log4Net and Rhino.Mocks used in all the same example. (It is a stupid example, but the intention was to show it works).</p>  <p><a href="http://lh6.ggpht.com/_Oy9HuksgrdU/S3N4ak4QpfI/AAAAAAAABKw/BnKnGThCkVw/s1600-h/image%5B9%5D.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://lh6.ggpht.com/_Oy9HuksgrdU/S3N4a-SvWvI/AAAAAAAABK0/EpHt1R8INq4/image_thumb%5B5%5D.png?imgmax=800" width="819" height="592" /></a> </p>  <p></p>  <p>If for some reason, it does not work for you, try to add </p>  <p>&lt;?xml version =&quot;1.0&quot;?&gt;   <br />&lt;configuration&gt;    <br />&#160; &lt;startup useLegacyV2RuntimeActivationPolicy=&quot;true&quot;&gt;    <br />&#160;&#160;&#160;&#160; &lt;supportedRuntime version=&quot;v2.0.5727&quot; /&gt;&#160; <br />&#160;&#160;&#160; &lt;supportedRuntime version=&quot;v4.0.21006&quot;/&gt;    <br />&#160; &lt;/startup&gt;    <br />&lt;/configuration&gt;</p>  <p>to your csc.exe.config/msbuild.exe.config/VCSExpress.exe.config/devenv.exe.config …</p>  <p>I initially thought it has something to do with not enabling Side-By-Side Execution of the&#160; compiler and stuff but it turns out that it is not the case. For your information,<strong>&#160; i have added supported runtime as .NET 2.0 <u>but then commented it to be sure that its ONLY the Target Framework that has to be changed.</u></strong></p>  
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
