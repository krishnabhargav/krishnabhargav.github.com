<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Making HTTP Requests to secure sites</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Your New Jekyll Site</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Making HTTP Requests to secure sites</h2>
<p class="meta">03 Oct 2008</p>

<div class="post">
<p><font face="Consolas" size="2">By the way, by secure I do not mean, for the HTTPS sites, but to those sites which have forms authentication. I recently had a situation where I needed to make a request to a web page. The page loads default user credentials from configuration (I know it is not secure, but its an intranet site, for internal use only). So the requests to be made was from a console application. So I thought, using HttpWebRequest would be good enough. But for subsequent requests, the user was not longer considered to be authenticated. But if I simulate the same using a Web Browser, then everything works fine. So I identified that ability to support cookies between requests was what missing, since I know my page does not differentiate requests using browser type. So, I wanted to make a request and support cookies at the same time. There are a lot of options to make a HTTP request in .NET, but I will for now only show the code that uses HttpWebRequest.</font></p>  <pre class="code"><font size="2"><font face="Consolas"><span style="color: blue">void </span>MakeRequest(<span style="color: blue">string </span>url)<br />{<br />            <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Making Request to : &quot; </span>+ url);<br />            </font></font><font size="2"><font face="Consolas"><span style="color: green">//WebClient wc = new WebClient();<br />            //wc.UseDefaultCredentials = true;<br />            //wc.CachePolicy = new RequestCachePolicy(RequestCacheLevel.Default);<br />            //StreamReader sr = new StreamReader(wc.OpenRead(url));<br />            </span><span style="color: #2b91af">HttpWebRequest </span>hwr = <span style="color: #2b91af">WebRequest</span>.Create(url) <span style="color: blue">as </span><span style="color: #2b91af">HttpWebRequest</span>;<br />            hwr.Credentials = <span style="color: #2b91af">CredentialCache</span>.DefaultCredentials;<br />            hwr.CookieContainer = <span style="color: blue">new </span><span style="color: #2b91af">CookieContainer</span>();<br />            <span style="color: #2b91af">StreamReader </span>sr = <span style="color: blue">new </span><span style="color: #2b91af">StreamReader</span>(hwr.GetResponse().GetResponseStream());<br />            <span style="color: blue">while </span>(!sr.EndOfStream) <span style="color: #2b91af">Console</span>.WriteLine(sr.ReadLine());<br />            <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Request Complete&quot;</span>);<br />}</font></font></pre><br /><br /><p><font face="Consolas" size="2">The commented code uses WebClient but id does not work out as expected.</font></p><br /><br /><p><font face="Consolas" size="2">What we did essentially is to create a HttpWebRequest and set Credentials(to support Integrated Security) and CookieContainer. And it works!</font></p>  
</div>


          <div class="footer">
            <div class="contact">
              <p>
                Your Name<br />
                What You Are<br />
                you@example.com
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/yourusername">github.com/yourusername</a><br />
                <a href="https://twitter.com/yourusername">twitter.com/yourusername</a><br />
              </p>
            </div>
          </div>
        </div>

    </body>
</html>
