<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Vedhava Sodhi - Musings of a Software Engineer v2.0</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    
    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="/">
                
                    <span class="blog-title">Vedhava Sodhi</span>
                 
            </a>
        </header>
        
        <span class="post-meta">
        	<time datetime="2008-10-03">03 Oct 2008</time>
        	
        		on
	        	
	        
       	</span>

        <h1 class="post-title">Making HTTP Requests to secure sites</h1>

        <section class="post-content">
            <p><font face="Consolas" size="2">By the way, by secure I do not mean, for the HTTPS sites, but to those sites which have forms authentication. I recently had a situation where I needed to make a request to a web page. The page loads default user credentials from configuration (I know it is not secure, but its an intranet site, for internal use only). So the requests to be made was from a console application. So I thought, using HttpWebRequest would be good enough. But for subsequent requests, the user was not longer considered to be authenticated. But if I simulate the same using a Web Browser, then everything works fine. So I identified that ability to support cookies between requests was what missing, since I know my page does not differentiate requests using browser type. So, I wanted to make a request and support cookies at the same time. There are a lot of options to make a HTTP request in .NET, but I will for now only show the code that uses HttpWebRequest.</font></p>  <pre class="code"><font size="2"><font face="Consolas"><span style="color: blue">void </span>MakeRequest(<span style="color: blue">string </span>url)<br />{<br />            <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Making Request to : &quot; </span>+ url);<br />            </font></font><font size="2"><font face="Consolas"><span style="color: green">//WebClient wc = new WebClient();<br />            //wc.UseDefaultCredentials = true;<br />            //wc.CachePolicy = new RequestCachePolicy(RequestCacheLevel.Default);<br />            //StreamReader sr = new StreamReader(wc.OpenRead(url));<br />            </span><span style="color: #2b91af">HttpWebRequest </span>hwr = <span style="color: #2b91af">WebRequest</span>.Create(url) <span style="color: blue">as </span><span style="color: #2b91af">HttpWebRequest</span>;<br />            hwr.Credentials = <span style="color: #2b91af">CredentialCache</span>.DefaultCredentials;<br />            hwr.CookieContainer = <span style="color: blue">new </span><span style="color: #2b91af">CookieContainer</span>();<br />            <span style="color: #2b91af">StreamReader </span>sr = <span style="color: blue">new </span><span style="color: #2b91af">StreamReader</span>(hwr.GetResponse().GetResponseStream());<br />            <span style="color: blue">while </span>(!sr.EndOfStream) <span style="color: #2b91af">Console</span>.WriteLine(sr.ReadLine());<br />            <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Request Complete&quot;</span>);<br />}</font></font></pre><br /><br /><p><font face="Consolas" size="2">The commented code uses WebClient but id does not work out as expected.</font></p><br /><br /><p><font face="Consolas" size="2">What we did essentially is to create a HttpWebRequest and set Credentials(to support Integrated Security) and CookieContainer. And it works!</font></p>  
        </section>

        

        <footer class="post-footer">
        	<!-- If we want to display author's name and bio -->
            

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Making HTTP Requests to secure sites&amp;url=/2008/10/03/Making-HTTP-Requests-to-secure-sites.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2008/10/03/Making-HTTP-Requests-to-secure-sites.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=/2008/10/03/Making-HTTP-Requests-to-secure-sites.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>
            
            
        	
        </footer>

    </article>

</main>


    <footer class="site-footer">
        <a class="subscribe icon-feed" href="/rss.xml"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
             <section class="copyright">All content copyright <a href="/">Vedhava Sodhi</a> &copy;  &bull; All rights reserved.</section>
             <section class="poweredby">Made with Jekyll using <a href="http://github.com/rosario/kasper">Kasper theme</a></section>
        </div>
    </footer>

    
    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-XXXXXXXX-X']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>   
</body>
</html>
