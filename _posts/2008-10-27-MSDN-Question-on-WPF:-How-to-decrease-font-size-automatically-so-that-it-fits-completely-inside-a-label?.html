---           
layout: post
title: MSDN Question on WPF: How to decrease font-size automatically so that it fits completely inside a label?
date: 2008-10-27 14:02:04 UTC
updated: 2008-10-27 14:02:04 UTC
comments: false
categories: 
---

<p><strong>Problem</strong>    <br />I came across an interesting question on WPF forums. A user has a fixed size label which text can be very large. But since the size of the label is fixed, the text gets truncated which he does not want. The user wanted to automatically decrease the font-size such that it fits into the label completely.     <br /><strong>Solution     <br /></strong>One solution is to write some code to determine the available space and based on the space available use <strong>FormattedText</strong> and set the text dynamically. But I devised an easier solution.     <br />There is a container in WPF called <strong>ViewBox</strong> which automatically scales the content inside such that it fits into the space completely. The idea is to use this ViewBox inside the template of the Label. The XAML code that does this is shown.</p>  <pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">Label </span><span style="color: red">Width</span><span style="color: blue">=&quot;200&quot; </span><span style="color: red">Height</span><span style="color: blue">=&quot;300&quot; </span><span style="color: red">Content</span><span style="color: blue">=&quot;This is a very long text that you would be using to set the control text&quot;&gt;<br />            &lt;</span><span style="color: #a31515">Label.Template</span><span style="color: blue">&gt;<br />                &lt;</span><span style="color: #a31515">ControlTemplate</span><span style="color: blue">&gt;<br />                    &lt;</span><span style="color: #a31515">Viewbox</span><span style="color: blue">&gt;<br />                        &lt;</span><span style="color: #a31515">ContentPresenter<br />              </span><span style="color: red">Content</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">TemplateBinding </span><span style="color: red">Property</span><span style="color: blue">=ContentControl.Content}&quot; /&gt;<br />                    &lt;/</span><span style="color: #a31515">Viewbox</span><span style="color: blue">&gt;<br />                &lt;/</span><span style="color: #a31515">ControlTemplate</span><span style="color: blue">&gt;<br />            &lt;/</span><span style="color: #a31515">Label.Template</span><span style="color: blue">&gt;<br />        &lt;/</span><span style="color: #a31515">Label</span><span style="color: blue">&gt;</span></pre><br />Now, when you run an application hosting such a label, the screenshots are shown.<br /><br /><br /><a href="http://lh3.ggpht.com/krishbhargava/SQXJ2F0hChI/AAAAAAAAAtg/7aBO5nGAbvc/s1600-h/image%5B3%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="484" alt="image" src="http://lh5.ggpht.com/krishbhargava/SQXJ2U8eDYI/AAAAAAAAAtk/_1Z0DakcvXY/image_thumb%5B1%5D.png?imgmax=800" width="597" border="0" /></a> <br /><br /><br />The same application with much longer text is shown below.<br /><br /><br /><a href="http://lh4.ggpht.com/krishbhargava/SQXJ2rswAqI/AAAAAAAAAto/rdvVvO4hlGU/s1600-h/image%5B10%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="484" alt="image" src="http://lh4.ggpht.com/krishbhargava/SQXJ3MsWJyI/AAAAAAAAAts/-COHaYB7b6k/image_thumb%5B6%5D.png?imgmax=800" width="484" border="0" /></a>&#160; <br />Hope this would be helpful to many!  