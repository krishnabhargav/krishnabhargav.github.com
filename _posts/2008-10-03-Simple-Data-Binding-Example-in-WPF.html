---           
layout: post
title: Simple Data Binding Example in WPF
date: 2008-10-03 20:16:25 UTC
updated: 2008-10-03 20:16:25 UTC
comments: false
categories: 
---

<p>There are two list boxes in my form. One list box should retrieve values from &quot;Roles&quot; property while another list box should show the items that are selected from the roles list box. You can do something like this in WPF very easily, provided you understand data binding. Here is how we do it.</p>  <p>The listbox should first bind to &quot;Roles&quot; a property we define in the code-behind of the window. So the items property is bound as   <br /><span style="color: blue">&lt;</span><span style="color: #a31515">ListBox </span><span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Roles</span><span style="color: blue">}&quot; </span><span style="color: red">SelectionMode</span><span style="color: blue">=&quot;Multiple&quot; </span><span style="color: red">Name</span><span style="color: blue">=&quot;roles&quot;/&gt;</span></p>  <p><span style="color: blue"></span>But where does the framework look for &quot;Roles&quot;?     <br />It first looks in the <strong>DataContext </strong>of the roles listbox. If it is not found, then it goes up to the parent and looks for its DataContext. In my example, the parent would be a StackPanel whose datacontext is set to &quot;this&quot; in constructor as shown.    <br /><span style="color: blue">public </span>Window1()    <br />{    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InitializeComponent();    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Roles = <span style="color: blue">new </span><span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt;() { <span style="color: #a31515">&quot;User&quot;</span>, <span style="color: #a31515">&quot;Super User&quot;</span>, <span style="color: #a31515">&quot;Lame User&quot;</span>, <span style="color: #a31515">&quot;Yourself&quot; </span>};    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; grid.DataContext = <span style="color: blue">this</span>;    <br />}</p>  <p>Also observe, the Roles property has been created in the constructor. But the roles property has to be a <strong>DependencyProperty</strong>, if the data binding has to work properly.    <br /><span style="color: blue">public static readonly </span><span style="color: #2b91af">DependencyProperty </span>RolesProperty =    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DependencyProperty</span>.Register(<span style="color: #a31515">&quot;Roles&quot;</span>, <span style="color: blue">typeof</span>(<span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt;), <span style="color: blue">typeof</span>(<span style="color: #2b91af">Window1</span>));    <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">public </span><span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt; Roles    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">get     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return </span>(<span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt;)GetValue(RolesProperty);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">set     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SetValue(RolesProperty, <span style="color: blue">value</span>);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>  <p>Now, let us look at the second listbox. The requirement is that the items inside the second listbox has to be pulled from the first list box. So its ItemsSource property has to bind with the &quot;SelectedItems&quot; property of roles listbox. Below, I show another way to binding without using Binding Expressions(&quot; {} &quot;). Instead we use Object Element &quot;Binding&quot; to perform the databinding.</p>  <pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;<br />    &lt;</span><span style="color: #a31515">ListBox.ItemsSource</span><span style="color: blue">&gt;<br />          &lt;</span><span style="color: #a31515">Binding</span><span style="color: blue">&gt;<br />              &lt;</span><span style="color: #a31515">Binding.ElementName</span><span style="color: blue">&gt;</span><span style="color: #a31515">roles</span><span style="color: blue">&lt;/</span><span style="color: #a31515">Binding.ElementName</span><span style="color: blue">&gt;<br />              &lt;</span><span style="color: #a31515">Binding.Path</span><span style="color: blue">&gt;</span><span style="color: #a31515">SelectedItems</span><span style="color: blue">&lt;/</span><span style="color: #a31515">Binding.Path</span><span style="color: blue">&gt;<br />          &lt;/</span><span style="color: #a31515">Binding</span><span style="color: blue">&gt;<br />    &lt;/</span><span style="color: #a31515">ListBox.ItemsSource</span><span style="color: blue">&gt;<br />&lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;</span></pre><br /><br /><p>Note that SelectedItems is already a depedency property.</p><br /><br /><p>The complete XAML is shown.</p><br /><br /><pre class="code"><span style="color: blue">&lt;</span><span style="color: #a31515">StackPanel </span><span style="color: red">Name</span><span style="color: blue">=&quot;grid&quot;&gt;<br />        &lt;</span><span style="color: #a31515">ListBox </span><span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding </span><span style="color: red">Roles</span><span style="color: blue">}&quot; </span><span style="color: red">SelectionMode</span><span style="color: blue">=&quot;Multiple&quot; </span><span style="color: red">Name</span><span style="color: blue">=&quot;roles&quot;&gt;<br />        &lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;<br />        &lt;</span><span style="color: #a31515">Label</span><span style="color: blue">&gt;</span><span style="color: #a31515">Selected Items</span><span style="color: blue">&lt;/</span><span style="color: #a31515">Label</span><span style="color: blue">&gt;<br />        &lt;</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;<br />            &lt;</span><span style="color: #a31515">ListBox.ItemsSource</span><span style="color: blue">&gt;<br />                &lt;</span><span style="color: #a31515">Binding</span><span style="color: blue">&gt;<br />                    &lt;</span><span style="color: #a31515">Binding.ElementName</span><span style="color: blue">&gt;</span><span style="color: #a31515">roles</span><span style="color: blue">&lt;/</span><span style="color: #a31515">Binding.ElementName</span><span style="color: blue">&gt;<br />                    &lt;</span><span style="color: #a31515">Binding.Path</span><span style="color: blue">&gt;</span><span style="color: #a31515">SelectedItems</span><span style="color: blue">&lt;/</span><span style="color: #a31515">Binding.Path</span><span style="color: blue">&gt;<br />                &lt;/</span><span style="color: #a31515">Binding</span><span style="color: blue">&gt;<br />            &lt;/</span><span style="color: #a31515">ListBox.ItemsSource</span><span style="color: blue">&gt;<br />        &lt;/</span><span style="color: #a31515">ListBox</span><span style="color: blue">&gt;<br />&lt;/</span><span style="color: #a31515">StackPanel</span><span style="color: blue">&gt;</span></pre><br /><br /><p>Note that, we cannot set SelectedItems property of a listbox in XAML, as the compiler complains about the property being read-only.<br />  <br />As I learn more about DataBinding, I would post the stuff here. </p>  