---           
layout: post
title: Using ANT for Java Development Builds
date: 2008-11-24 14:25:54 UTC
updated: 2008-11-24 14:25:54 UTC
comments: false
categories: 
---

<h5>Objectives</h5>  <ul>   <li>Getting familiar with installation of ANT and setting classpath to be able to run ANT tasks </li>    <li>Get a top level view of using ANT to compile and run Java applications </li>    <li>Writing a simple ant build script</li> </ul>  <h5>Software requirements</h5>  <ul>   <li>Apache ANT 1.7.0 - <a href="http://apache.ant.org">http://apache.ant.org</a></li>    <li>Java SDK 1.6 ( Java 1.5 would still work, but I prefer to run the latest stable release ) </li>    <li>Simple XML editor [optional]. You can possibly use <a href="http://www.notepad2.com">Notepad2</a> if you are running windows or use Vim if running Linux.</li> </ul>  <p>Before we actually dive into the installation and running ANT, let us understand what ant is and then we might have a strong reason on why one should use ANT scripts in their projects.</p>  <h5>What is ANT? Why use it?</h5>  <p>Apache ANT is one of the most widely used build tool. I am pretty sure most of you have worked with Make files and if Make is the ultimate build tool for any applications on Linux, Ant is the equivalent edition used mostly for Java applications ( and could be used for .NET applications too, but not many really care ). While Makefiles use plain text instructions, Ant uses XML based instructions. These xml files are usually called Ant Scripts, even though they do not have any script as such. It is just a set of tasks that we define, that we ask the ant tool to execute for us, thereby automating almost any process in a software development lifecycle. Ant pre-defines a set of tasks for compiling packages, running Java programs, creating JAR or WAR files, running Unit tests and a lot more. Ant is used across the industry, for its simplicity, portability and especially the power it brings to automation. You can integrate Ant with most of the popular IDE like Eclipse and Netbeans. Infact Netbeans generates an Ant script and it is executed whenever you build or run a file or a project. In the second tutorial, we look at <a href="http://truebuddi.wikidot.com/ant-ide">how to integrate Ant with Eclipse and Netbeans</a>.</p>  <p>Apart from the sheer simplicity that it brings into development process, to be practical, it adds value to your resume. As already mentioned, Ant is used scross the industry and as a prospective developer, you are required to be able to write Ant scripts. Coming back to the non-practical view, Ant scripts is the best way you can automate your process. Consider a simple Client-Server Program where you are required to first compile the programs, start the server, then start the client and each time you do that, even if you use IDE, you are supposed to do some amount of work. But with ant, you can automate the entire process. After the tutorial 2, you would still use IDE but would use Ant scripts to build and run your code. You would use IDE for debugging purposes, unless someone comes up with a tutorial on how to use Command line debugger that ships with JDK. Ok, enough of the theory, lets get started with some practical stuff!</p>  <h5>Installing ANT</h5>  <ol>   <li>Download Ant toolkit from <a href="http://mirrors.kahuki.com/apache/ant/binaries/apache-ant-1.7.0-bin.zip">http://mirrors.kahuki.com/apache/ant/binaries/apache-ant-1.7.0-bin.zip</a></li>    <li>Extract the archive on to your local file system. Usually I place all my development tools in a special folder in D: drive called &quot;development&quot;. This helps me quickly find any development tool, whenever needed. </li>    <li>Now you need to add Ant to your command prompt path. I assume you are using Windows (for setting classpath on Linux, please visit my blog entry *<a href="http://krishnabhargav.blogspot.com/2007/02/setting-path-variables-in-linux.html">here</a>). </li>    <li>If you path is set, then you can just type the command &quot;ant&quot; in any command prompt window and the command prompt would be able to locate your ant executable. To set the classpath on Windows,      <ol>       <li>Right click on My Computer. Go to Properties and select the Advanced tab page. (In Vista, you right click on Computer, Go to Properties and then go to Advanced tab) </li>        <li>Click on Environment variables. You get a new dialog window (image shown below). There are two types of variables, User and System Variables. We would now add a System Variable. To do that, first click New &#8230; button and create a new variable called &quot;ANT_HOME&quot;. In the variable value, you give the path to the directory of Ant. In my case, it is &quot;D:\Development\Apache-Ant-1.7.0&quot;. Click ok and now you see a new ANT_HOME variable set. </li>        <li>Scroll down the list to locate &quot;Path&quot; variable. Select the variable and then click on Edit.. button. Now in the variable value textbox, append the statement &quot;%ANT_HOME%\bin&quot;. A variable can have multiple values in which case, we seperate them using &quot;;&quot;. The new value should look something like &quot;previous values;%ANT_HOME%\bin&quot;. Take a look at the image shown below.</li>     </ol>   </li> </ol>  <p><a href="http://lh4.ggpht.com/_Oy9HuksgrdU/SSq5ZpvnsUI/AAAAAAAAAvc/S213z9LhFXQ/s1600-h/image%5B7%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="484" alt="image" src="http://lh6.ggpht.com/_Oy9HuksgrdU/SSq5adfSsFI/AAAAAAAAAvg/qrzPNTIcrZY/image_thumb%5B5%5D.png?imgmax=800" width="415" border="0" /></a> </p>  <ol>   <li>Now test to see if you have correctly set your path. To do this, go to command prompt and type &quot;ant&quot;. If everything works fine, you should see a message which says &quot;build.xml does not exist!&quot;. This also should tell you that, default script file that ant looks for is a build.xml (in case of <strong>make</strong> it is Makefile)</li> </ol>  <p>Assuming, Ant is setup and ready to use, we would now write a simple &quot;Hello&quot; program in Java. The program takes in a command line argument and prints a message along with the argument passed.</p>  <h5>Sample Java Program</h5>  <pre class="code"><font size="2"><font face="Consolas">package truebuddi.learning.ant;<br /> <br />import java.lang.*;<br /> <br /><span style="color: blue">public class </span></font></font><font size="2"><font face="Consolas"><span style="color: #2b91af">HelloAntWorld<br /></span>{<br />   <span style="color: blue">public static void </span>main(String[] args)<br />   { <br />      <span style="color: blue">if</span>(args.length&lt;1)<br />      {<br />        System.<span style="color: blue">out</span>.println(<span style="color: #a31515">&quot;Invalid number of arguments. Program terminating ... &quot;</span>);<br />        <span style="color: blue">return</span>; </font></font><font size="2"><font face="Consolas"><span style="color: green">//or System.exit(-1);<br />      </span>}<br /> <br />      </font></font><font size="2"><font face="Consolas"><span style="color: green">//if the execution reaches here, argument have been passed accurately.<br />      </span>System.<span style="color: blue">out</span>.println(<span style="color: #a31515">&quot;Welcome to Ant world! I hope you executed the program via Ant&quot;</span>);<br />      String message = String.format(<span style="color: #a31515">&quot;Arguments you passed : %s&quot;</span>,args[0]); </font></font><font size="2"><font face="Consolas"><span style="color: green">//Looks like C format specifiers ! Yes it is!<br />      </span>System.<span style="color: blue">out</span>.println(message); </font></font><font size="2"><font face="Consolas"><span style="color: green">// print the message.<br />   </span>}<br />}</font></font></pre><br /><a href="http://11011.net/software/vspaste"></a><br /><br /><p>Save the file at a location like &quot;D:\projectFolder\src\<strong>truebuddi\learning\ant\HelloAntWorld.java</strong>&quot; (The section in bold should match with your package statement. I would then place my ant build file at &quot;D:\projectFolder\build.xml&quot;. My directory structure looks like shown below.</p><br /><br /><p><a href="http://lh6.ggpht.com/_Oy9HuksgrdU/SSq5akuh0DI/AAAAAAAAAvk/Ciw0-hP9b2g/s1600-h/image%5B10%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="122" alt="image" src="http://lh4.ggpht.com/_Oy9HuksgrdU/SSq5bOLZ-LI/AAAAAAAAAvo/UUyrybMGVqQ/image_thumb%5B6%5D.png?imgmax=800" width="148" border="0" /></a> </p><br /><br /><h5>Writing your first ant script</h5><br /><br /><p>Now let us write a simple ant script that has two tasks - first to compile the program and the second to run the program. The complete Ant script looks something like shown below. Reference: <a href="http://ant.apache.org/manual/index.html">http://ant.apache.org/manual/index.html</a></p><br /><br /><pre class="code"><font size="2"><font face="Consolas"><span style="color: blue">&lt;!-- </span><span style="color: green">default=compile implies, the default task that is run when ant executes this script is the compile task </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />&lt;</span><span style="color: #a31515">project </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">LearningAnt</span>&quot; <span style="color: red">default</span><span style="color: blue">=</span>&quot;<span style="color: blue">compile</span>&quot; <span style="color: red">basedir</span><span style="color: blue">=</span>&quot;<span style="color: blue">.</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />  &lt;</span><span style="color: #a31515">description</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    </span>First Ant build script to compile and run truebuddi.learning.ant.HelloWorld program<br />  <span style="color: blue">&lt;/</span><span style="color: #a31515">description</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />  &lt;!-- </span><span style="color: green">set global properties for this build </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />  &lt;</span><span style="color: #a31515">property </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">src</span>&quot; <span style="color: red">location</span><span style="color: blue">=</span>&quot;<span style="color: blue">src</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />  &lt;</span><span style="color: #a31515">property </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">build</span>&quot; <span style="color: red">location</span><span style="color: blue">=</span>&quot;<span style="color: blue">build</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br /><br />  &lt;</span><span style="color: #a31515">target </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">init</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    &lt;!-- </span><span style="color: green">Create the build directory structure used by compile </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />    &lt;</span><span style="color: #a31515">mkdir </span><span style="color: red">dir</span><span style="color: blue">=</span>&quot;<span style="color: blue">${build}</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />  &lt;/</span><span style="color: #a31515">target</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br /><br />  &lt;!-- </span><span style="color: green">depends=&quot;init&quot; implies that before compile is actually run, init is executed </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />  &lt;</span><span style="color: #a31515">target </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">compile</span>&quot; <span style="color: red">depends</span><span style="color: blue">=</span>&quot;<span style="color: blue">init</span>&quot; <span style="color: red">description</span><span style="color: blue">=</span>&quot;<span style="color: blue">compile the source </span>&quot; </font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    &lt;!-- </span><span style="color: green">Compile the java code from ${src} into ${build} </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />    &lt;</span><span style="color: #a31515">javac </span><span style="color: red">srcdir</span><span style="color: blue">=</span>&quot;<span style="color: blue">${src}</span>&quot; <span style="color: red">destdir</span><span style="color: blue">=</span>&quot;<span style="color: blue">${build}</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />  &lt;/</span><span style="color: #a31515">target</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br /><br />  &lt;</span><span style="color: #a31515">target </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">execute</span>&quot; <span style="color: red">depends</span><span style="color: blue">=</span>&quot;<span style="color: blue">compile</span>&quot; <span style="color: red">description</span><span style="color: blue">=</span>&quot;<span style="color: blue">Run the program</span>&quot; </font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    &lt;</span><span style="color: #a31515">java </span><span style="color: red">classname</span><span style="color: blue">=</span>&quot;<span style="color: blue">truebuddi.learning.ant.HelloAntWorld</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />      &lt;</span><span style="color: #a31515">arg </span><span style="color: red">value</span><span style="color: blue">=</span>&quot;<span style="color: blue">I am running this from Ant!</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />      &lt;</span><span style="color: #a31515">classpath</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />        &lt;</span><span style="color: #a31515">pathelement </span><span style="color: red">location</span><span style="color: blue">=</span>&quot;<span style="color: blue">build</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />      &lt;/</span><span style="color: #a31515">classpath</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    &lt;/</span><span style="color: #a31515">java</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />  &lt;/</span><span style="color: #a31515">target</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br /><br />  &lt;</span><span style="color: #a31515">target </span><span style="color: red">name</span><span style="color: blue">=</span>&quot;<span style="color: blue">clean</span>&quot; <span style="color: red">description</span><span style="color: blue">=</span>&quot;<span style="color: blue">clean up</span>&quot; </font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br />    &lt;!-- </span><span style="color: green">Delete the ${build} and ${dist} directory trees </span></font></font><font size="2"><font face="Consolas"><span style="color: blue">--&gt;<br />    &lt;</span><span style="color: #a31515">delete </span><span style="color: red">dir</span><span style="color: blue">=</span>&quot;<span style="color: blue">${build}</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />    &lt;</span><span style="color: #a31515">delete </span><span style="color: red">dir</span><span style="color: blue">=</span>&quot;<span style="color: blue">${dist}</span>&quot;</font></font><font size="2"><font face="Consolas"><span style="color: blue">/&gt;<br />  &lt;/</span><span style="color: #a31515">target</span></font></font><font size="2"><font face="Consolas"><span style="color: blue">&gt;<br /><br />&lt;/</span><span style="color: #a31515">project</span></font></font><span style="color: blue"><font face="Consolas" size="2">&gt;</font><br /></span></pre><br /><a href="http://11011.net/software/vspaste"></a><br /><br /><ul><br />  <li>Important points <br />    <ul><br />      <li>Please take a look at default=&quot;compile&quot; and depends=&quot;xxxx&quot; attributes in the script. Read the comments. </li><br /><br />      <li>javac is used as a tag which is a pre-defined ant task. It executes the java compiler on the code in the &quot;src&quot; folder and copies the output to build folder. Right now in this example, we do not use external libraries and if used we would have had them within classpath tags in the ant file. It would be evident in the future tutorials. For now, we just let the ant know that our classpath would have 'build' directory. </li><br /><br />      <li>There are four target operations that ant can execute - init, compile, execute and clean.</li><br />    </ul><br />  </li><br /></ul><br /><br /><h5>Running the ant script</h5><br /><br /><p>Having saved the above xml as &quot;build.xml&quot; in the project root folder, go to command prompt and navigate to the root. Run the following commands<br />  <br />1. To compile the program, run &quot;ant&quot;. Since the default target is compile, the program would compile and you get output something like shown below.</p><br /><br /><p><a href="http://lh4.ggpht.com/_Oy9HuksgrdU/SSq5bSMYiEI/AAAAAAAAAvs/YdMldH_fmmA/s1600-h/image%5B14%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="178" alt="image" src="http://lh4.ggpht.com/_Oy9HuksgrdU/SSq5bpUfPEI/AAAAAAAAAvw/LdYTfZv9sAA/image_thumb%5B8%5D.png?imgmax=800" width="644" border="0" /></a> </p><br /><br /><p>2. To run the program, run the command &quot;ant execute&quot;.</p><br /><br /><p><a href="http://lh3.ggpht.com/_Oy9HuksgrdU/SSq5b9Gl58I/AAAAAAAAAv0/puszjuuw6NY/s1600-h/image%5B18%5D.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="163" alt="image" src="http://lh6.ggpht.com/_Oy9HuksgrdU/SSq5cmjlwwI/AAAAAAAAAv4/VmFXewUMQi8/image_thumb%5B10%5D.png?imgmax=800" width="644" border="0" /></a> </p><br /><br /><p>[Optional] The program could be executed as &quot;java -classpath buddi truebuddi.learning.ant.HelloAntWorld message&quot;</p><br /><br /><p>I hope this tutorial would get you started with using Ant to compile and run Java Programs. I have even shown you on how to set classpath in ant scripts, how to pass arguments to Java programs, shown you the ant tasks like java, javac, mkdir ,etc.</p>  