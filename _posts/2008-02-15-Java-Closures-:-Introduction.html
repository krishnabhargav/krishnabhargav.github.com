---           
layout: post
title: Java Closures : Introduction
date: 2008-02-15 03:00:35 UTC
updated: 2008-02-15 03:00:35 UTC
comments: false
categories: closures early adoption Java 7
---

<p align="justify"><a title="Java Closures" href="http://www.javac.info/" target="_blank">Folks</a> have been working on getting closures into the next release of Java - Dolphin or Java 7. In the past I have posted a tiny video on <a href="http://krishnabhargav.blogspot.com/2008/02/closures-in-groovy.html" target="_blank">how to work with closures in Groovy</a>.  </p><p align="justify">Go to www.javac.info to download the closures prototype compiler and extract it. Extract the archive using tar command on linux(that is what I use for development and testing out something new on Java). <p align="justify">You can notice a "java" command and "javac" command. Now if you already have JDK in your path(which you should have in order to tryout the prototype compiler), you differentiate between "java" in your path and the "java" in this directory by simply doing a "./". <p align="justify">To compile a Closure Demo you need to say<br /></p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:4ba0fe39-8edc-4c06-8277-eff7638d9dbe"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>./</span><span>javac MyClosureDemo</span><span>.</span><span>java </span></pre></div></div><p align="justify">I put ./ in front of "javac" so as to differentiate between javac which is already in my path. </p><p align="justify">Now try running these commands...</p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:6c1ce282-9f13-4ddc-b79f-c3327f765b04"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>$java </span><span>-</span><span>version<br />$.</span><span>/</span><span>java </span><span>-</span><span>version </span></pre></div></div><p align="justify">You would notice that the one with ./java returns an internal bootstrap version number while the java returns the actual 1.x release.  </p><p align="justify">Lets get started and write a simple closure.Within main() method try this statement.</p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:bae4a475-7a49-48c2-baa0-133caec07c48"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>{String </span><span>=&gt;</span><span> </span><span>int</span><span>} myFirstClosure;<br />myFirstClosure </span><span>=</span><span> { String name </span><span>=&gt;</span><span>name.length() }; </span></pre></div><pre></pre></div><p align="justify">Two things to notice :<br />1. Firstly name is the parameter this closure takes.<br />2. There is no "RETURN" statement (return). Some of us not happy about the missing <strong>return</strong> and how it deviates from the-Java-way. Anyway, I do not give a damn. We should be happy about that a lot of people have put in a lot of effort to come up with something so cool. Instead of complaining, appreciate their effort.<br /><br />Anyway, the last statement with no ; is returned to the closure. If there is no such statement without a ; then its a closure that returns void. </p><p align="justify">Since it returns an integer, we can declare this closure as<br /></p><div align="justify"><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:98cb5c90-1a00-4f4f-a5df-0cd119354890"><pre><span>{ String </span><span>=&gt;</span><span> </span><span>int</span><span> } myFirstClosure; </span><br /></pre></div></div><p align="justify">This is of the format </p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:e3c52d2e-3450-4883-abbe-45dd0cbf9099"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>{ parameters </span><span>=&gt;</span><span> returnType } identifier </span></pre></div><pre></pre></div><p align="justify">As like any method, returnType is mandatory.<br /></p><p align="justify">You invoke the closure by calling the "invoke()" method and passing to it the parameters that the closure takes in. </p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:25505032-8f10-469d-9609-1a9d5bff3447"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>int</span><span> Length </span><span>=</span><span> myFirstClosure.invoke(</span><span>"</span><span>Something</span><span>"</span><span>); </span></pre></div><pre></pre></div><p align="justify">Try out the shown closure, save the file and compile using the ./javac the prototype compiler. The compilation should be successful!<br /></p><p align="justify">Complete Code: </p><div align="justify"><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:32c1edcc-e9b3-4114-8006-8d83fcf08cca"><pre><span>package screencast; </span><span>//</span><span> I placed the demos in this package</span><span><br /></span><span><br /></span><span>/*</span><span>*<br />* This is one of my first demos on how to use closure!<br /></span><span>*/</span><span><br /></span><span>class</span><span> FirstClosure {<br /><br /></span><span>public</span><span> </span><span>static</span><span> </span><span>void</span><span> main(String[] args) {<br /><br />{ String </span><span>=&gt;</span><span> </span><span>int</span><span> } myFirstClosure;<br />myFirstClosure </span><span>=</span><span> { String name </span><span>=&gt;</span><span> name.length() };<br /></span><span>//</span><span>{formal =&gt; returntype } identifier;</span><span><br /></span><span><br />String name </span><span>=</span><span> </span><span>"</span><span>Bhargav</span><span>"</span><span>;<br /><br /></span><span>int</span><span> length </span><span>=</span><span> myFirstClosure.invoke(name);<br /><br />System.</span><span>out</span><span>.printf(</span><span>"</span><span>My name is %s and the length of my name is %d</span><span>"</span><span>,name,length);<br /><br />}<br />}<br /><br /></span><br /></pre></div></div><p align="justify">Ok, if you look at what was generated in the "javax" directory. You should see Interfaces in the package javax.lang.function. Some of the interfaces that I know are I, II, III and a closure is actually translated into these interfaces and its body becomes the body of the invoke() method which these interfaces define! More implementation details <a title="Closure Java First Programs" href="http://tronicek.blogspot.com/2007/12/closures-closure-is-form-of-anonymous_28.html" target="_blank">here</a>.<br /></p><p align="justify">Now run the program using </p><div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:9fd16a35-ed92-49e7-a298-543b59038772"><div align="justify"><pre><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span>.</span><span>/</span><span>java screencast.FirstClosure </span></pre></div><pre></pre></div><p align="justify">And you are done!!! </p><p align="justify">Get started and refer www.javac.info, there is amazing tutorial posted there! </p>