---           
layout: post
title: String comparisons : == vs. equals()
date: 2008-07-24 21:35:46 UTC
updated: 2008-07-24 21:35:46 UTC
comments: false
categories: .NET 3.5 Code Snippets Java Programming
---

<p>It is a well known that you cannot compare two objects obj1 and obj2 using == operator. == operator checks for the equality of the references not the equality of the objects. Just a little snippet is shown below </p> <div class="wlWriterSmartContent" id="scid:57F11A72-B0E5-49c7-9094-E3A15BD5B5E6:892b366b-0266-4e5b-af70-71df4e126a42" style="margin: 0px; padding: 0px; display: inline; float: none; width: 301px;"><pre style="background-color: White;"><div><!--  Code highlighting produced by Actipro CodeHighlighter (freeware) http://www.CodeHighlighter.com/  --><span style="color: rgb(0, 0, 0);">Point p1 </span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);"> Point(</span><span style="color: rgb(0, 0, 0);">100</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">100</span><span style="color: rgb(0, 0, 0);">);<br />Point p2 </span><span style="color: rgb(0, 0, 0);">=</span><span style="color: rgb(0, 0, 0);"> </span><span style="color: rgb(0, 0, 255);">new</span><span style="color: rgb(0, 0, 0);"> Point(</span><span style="color: rgb(0, 0, 0);">100</span><span style="color: rgb(0, 0, 0);">,</span><span style="color: rgb(0, 0, 0);">100</span><span style="color: rgb(0, 0, 0);">);<br />System.out.println(p1</span><span style="color: rgb(0, 0, 0);">==</span><span style="color: rgb(0, 0, 0);">p2); </span><span style="color: rgb(0, 128, 0);">//</span><span style="color: rgb(0, 128, 0);"> ??</span></div></pre></div>The above code snippet, when run, displays "false" in the output console. But still both p1 and p2 refers to a coordinate (100,100). So if you wish to get your equality to be true for such cases (where the object content! matches), then you should be using "equals()" method. This works for almost all the classes shipped with JDK. For this to work on the objects of the classes that you write (eg: Employee class or Chair or Bench.java), then you should override the method "public boolean equals(Object two)" and implement your meaning of equality of the objects of your class. Also note that, it is highly recommended and important that you override the "int hashCode()" method when you override the "equals" method.<br /><br />Anyway, now when we deal with String comparisons, one should remember that "Strings" are not value types but are reference types (I mean String is a class). So Strings have to compared for equality using <strong>equals</strong> method instead of == operator. But the way the JVM is implemented, there are cases under which the == returns true for matching strings. So what are the cases?<br /><br />Case 1: Where == returns true<br /><p></p><pre style="background: white none repeat scroll 0% 50%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">String s1 = "<span style="color: rgb(139, 0, 0);">Krishna</span>";<br />String s2 = "<span style="color: rgb(139, 0, 0);">Krishna</span>";<br /><span style="color: rgb(0, 0, 255);">if</span>(s1==s2)<br />System.<span style="color: rgb(0, 0, 255);">out</span>.println("<span style="color: rgb(139, 0, 0);">Strings are equal!!</span>");<br /><span style="color: rgb(0, 0, 255);">else</span><br />System.<span style="color: rgb(0, 0, 255);">out</span>.println("<span style="color: rgb(139, 0, 0);">You cannot use == here</span>");</pre><p>Trying running the code as it is and you see the "Strings are equal" on the console. Well can you guess why?<br /><br />The reason for the == operator to work in this case is that the Java compiler optimizes the strings s1 and s2. Since they are both "initialized" to "Krishna", instead of having two different string objects, optimization is done by having only one object and both s1 and s2 refer to the same "Krishna" object. Remember that the ==  operator only works for "static" kind of initialization. So if it was the case where s1 = new String("Krishna"); then s1 == s2 would return false instead of true, though it appears both are being initialized to the same "Krishna". Let us see another case where s1 == s2 fails.<br /><br />Case 2: Where == returns false and equals() return true</p><pre style="background: white none repeat scroll 0% 50%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">String s1 = "<span style="color: rgb(139, 0, 0);">Krishna</span>";<br />String s2 = <span style="color: rgb(0, 0, 255);">new</span> String(s1);<br /><span style="color: rgb(0, 0, 255);">if</span>(!(s1==s2))<br />System.out.println("<span style="color: rgb(139, 0, 0);">You cannot use == here</span>");<br /><span style="color: rgb(0, 0, 255);">else</span> <span style="color: rgb(0, 0, 255);">if</span>(s1.equals(s2))<br />System.out.println("<span style="color: rgb(139, 0, 0);">You should use 'equals' method in all cases</span>");</pre><pre style="background: white none repeat scroll 0% 50%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><span style="color: rgb(0, 0, 0);font-family:Trebuchet MS;" >Anyway the moral of the story is that you should always use "equals" to compare strings and should never use == even though it works in few cases.</span></pre>